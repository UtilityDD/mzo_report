  // Add PT<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PTR Oil Testing Entry</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="p-4">

<div class="container">
  <h3 class="mb-4">PTR Oil Testing Record Form</h3>

  <form id="testForm">
    <div class="row mb-3">
      <div class="col">
        <label>Region</label>
        <select class="form-select" id="region" required></select>
      </div>
      <div class="col">
        <label>Division</label>
        <select class="form-select" id="division" required></select>
      </div>
      <div class="col">
        <label>Substation</label>
        <select class="form-select" id="substation" required></select>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col">
        <label>PTR (Equipment Info)</label>
        <select class="form-select" id="ptrSelect" required></select>
        <div class="form-text">
          Can't find PTR? <a href="#" onclick="showPTRModal()">Add New</a>
        </div>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col">
        <label>Sample Collection Date</label>
<input type="date" class="form-control" name="Sample Collection Date" id="sampleCollectionDate" required>
      </div>
      <div class="col">
        <label>Sample Testing Date</label>
<input type="date" class="form-control" name="Sample Testing Date" id="sampleTestingDate" required>
      </div>
      <div class="col">
        <label>Sample Collected By</label>
        <input type="text" class="form-control" name="Sample Collected By">
      </div>
    </div>
<div class="row mb-3">
      <div class="col">
        <label>Source Referance</label>
        <input type="text" class="form-control" name="Source Referance">
      </div>
      <div class="col">
        <label>Testing Referance</label>
        <input type="text" class="form-control" name="Testing Referance">
      </div>
<div class="col">
  <label>Oil Sample Position</label>
  <select class="form-select" name="Oil Sample Position" required>
    <option value="">Select</option>
    <option value="Top">Top</option>
    <option value="Bottom">Bottom</option>
    <option value="OLTC">OLTC</option>
  </select>
</div>
    </div>

    <div class="row mb-3">
<div class="col">
  <label>Physical Appearance</label>
  <select class="form-select" name="Physical Appearance" required>
    <option value="">Select</option>
    <option value="Pale Yellow">Pale Yellow</option>
    <option value="Clear">Clear</option>
    <option value="Brown">Brown</option>
  </select>
</div>
      <div class="col">
        <label>Density (gm/CC)</label>
        <input type="number" step="0.0001" class="form-control" name="Density (gm/CC)">
      </div>
      <div class="col">
        <label>BDV with 2.5mm Gap (kV)</label>
        <input type="number" step="0.01" class="form-control" name="BDV with 2.5mm Gap (kV)">
      </div>
    </div>

    <div class="row mb-3">
      <div class="col">
        <label>Acidity (mg of KOH/gm)</label>
        <input type="number" step="0.0001" class="form-control" name="Acidity (mg of KOH/gm)">
      </div>
      <div class="col">
        <label>Specific Resistance at 27 °C (ohm-cm)</label>
        <input type="number" step="1" class="form-control" name="Specific Resistance at 27 °C (ohm-cm)">
      </div>
      <div class="col">
        <label>Specific Resistance at 90 °C (ohm-cm)</label>
        <input type="number" step="1" class="form-control" name="Specific Resistance at 90 °C (ohm-cm)">
      </div>
    </div>

    <div class="row mb-3">
      <div class="col">
        <label>Dielectric Disssipation Factor (tan δ)</label>
        <input type="number" step="0.0001" class="form-control" name="Dielectric Disssipation Factor (tan δ)">
      </div>
      <div class="col">
        <label>Moisture Content (PPM)</label>
        <input type="number" class="form-control" name="Moisture Content (PPM)">
      </div>
      <div class="col">
        <label>IFT (mN/m)</label>
        <input type="number" step="0.01" class="form-control" name="IFT (mN/m)">
      </div>
    </div>

    <div class="mb-3">
      <label>Observations</label>
      <textarea class="form-control" name="Observations" rows="3"></textarea>
    <button type="submit" class="btn btn-primary">Submit Record</button>
  </form>

  <!-- PTR Modal -->
  <div class="modal fade" id="ptrModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add New PTR</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <form id="ptrForm">
          <div class="modal-body row g-3 p-3">
<div class="col-md-4">
  <label>Region</label>
  <select name="Region" id="modalRegion" class="form-select" required></select>
</div>
<div class="col-md-4">
  <label>Division</label>
  <select name="Division" id="modalDivision" class="form-select" required></select>
</div>
<div class="col-md-4">
  <label>Substation</label>
  <select name="Substation" id="modalSubstation" class="form-select" required></select>
</div>
<div class="col-md-4">
  <label>Equipment</label>
  <input name="Equipment" class="form-control" value="PTR" readonly>
</div>

<div class="col-md-4">
  <label>Capacity (MVA)</label>
  <select name="Capacity (MVA)" class="form-select" required>
    <option value="">Select</option>
    <option value="3">3</option>
    <option value="6.3">6.3</option>
    <option value="10">10</option>
    <option value="20">20</option>
  </select>
</div>

<div class="col-md-4">
  <label>Make</label>
  <select name="Make" class="form-select" required>
    <option value="">Select</option>
    <option value="Marson's">Marson's</option>
    <option value="Tata">RTS Power</option>
    <option value="Joi">Toshiba</option>
    <option value="HP">Vijai</option>
  </select>
</div>

<div class="col-md-4">
  <label>Year of Manufacture</label>
  <select name="Year of Manufacture" id="yearDropdown" class="form-select" required></select>
</div>
<div class="col-md-4">
  <label>Serial No.</label>
  <input type="text" name="Serial No." class="form-control" required>
</div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-success" id="addPtrBtn">
              <span class="btn-text">Add PTR</span>
              <span class="spinner-border spinner-border-sm d-none" role="status"></span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Test Record Confirmation Modal -->
  <div class="modal fade" id="confirmTestModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Test Record Submission</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to submit this test record?</p>
          <div id="testRecordSummary" class="bg-light p-3 rounded"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="confirmTestSubmit">
            <span class="btn-text">Yes, Submit</span>
            <span class="spinner-border spinner-border-sm d-none" role="status"></span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- PTR Confirmation Modal -->
  <div class="modal fade" id="confirmPtrModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm PTR Addition</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to add this PTR?</p>
          <div id="ptrSummary" class="bg-light p-3 rounded"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-success" id="confirmPtrSubmit">
            <span class="btn-text">Yes, Add PTR</span>
            <span class="spinner-border spinner-border-sm d-none" role="status"></span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div class="modal fade" id="successModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title">Success!</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="text-center">
            <i class="bi bi-check-circle-fill text-success" style="font-size: 3rem;"></i>
            <p class="mt-3" id="successMessage">Operation completed successfully!</p>
          </div>
        </div>
<div class="modal-footer d-flex justify-content-between">
  <button type="button" class="btn btn-outline-primary d-none" id="addAnotherPtrBtn">
    <i class="bi bi-plus-circle"></i> Add Another PTR
  </button>
  <button type="button" class="btn btn-success" data-bs-dismiss="modal">OK</button>
</div>

      </div>
    </div>
  </div>
</div>

<script>
const scriptUrl = 'https://script.google.com/macros/s/AKfycbxhEdt6LWidyEwq0VUoHv55vSXX1DyWbAHqEppFA1X59j43mlgfxS1NVhXNdz5KpVbe/exec';
let mapData = [], ptrData = [];
let pendingTestRecord = null;
let pendingPtrData = null;

// Utility functions for loading states
function setLoadingState(button, isLoading) {
  const btnText = button.querySelector('.btn-text');
  const spinner = button.querySelector('.spinner-border');
  
  if (isLoading) {
    btnText.classList.add('d-none');
    spinner.classList.remove('d-none');
    button.disabled = true;
  } else {
    btnText.classList.remove('d-none');
    spinner.classList.add('d-none');
    button.disabled = false;
  }
}

function showSuccessModal(message, showAddAnother = false) {
  document.getElementById('successMessage').textContent = message;

  const addBtn = document.getElementById('addAnotherPtrBtn');
  if (showAddAnother) {
    addBtn.classList.remove('d-none');
  } else {
    addBtn.classList.add('d-none');
  }

  new bootstrap.Modal(document.getElementById('successModal')).show();
}

document.getElementById('addAnotherPtrBtn').addEventListener('click', () => {
  const successModal = bootstrap.Modal.getInstance(document.getElementById('successModal'));
  successModal.hide();

  // Clear and reopen the PTR modal
  document.getElementById("ptrForm").reset();

  // If region/div/substation were already selected, prefill again
  document.getElementById("modalRegion").value = document.getElementById("region").value || '';
  document.getElementById("modalDivision").value = document.getElementById("division").value || '';
  document.getElementById("modalSubstation").value = document.getElementById("substation").value || '';

  new bootstrap.Modal(document.getElementById("ptrModal")).show();
});

// Initial load
document.addEventListener("DOMContentLoaded", () => {
  fetchData();
  populateYearDropdown(); // ✅ Add this here
});


function fetchData() {
  fetch(scriptUrl + '?action=getInitialData')
    .then(res => res.json())
    .then(data => {
      mapData = data.map;
      ptrData = data.ptrs;
      populateRegionDropdown();
      populatePTRDropdown();
      populateModalRegionDropdown(); // ← Important

    })
    .catch(err => console.error('Error fetching data:', err));
}

function populateRegionDropdown() {
  const regionSelect = document.getElementById("region");
  const divisionSelect = document.getElementById("division");
  const substationSelect = document.getElementById("substation");

  // Populate Region dropdown
  const regionSet = [...new Set(mapData.map(r => r.Region))];
  regionSelect.innerHTML = `<option value="">Select</option>` + regionSet.map(r => `<option>${r}</option>`).join("");

  // === Event Listeners (attach once globally) ===

  regionSelect.addEventListener("change", () => {
    const selectedRegion = regionSelect.value;

    // Populate Division
    const divisions = [...new Set(mapData.filter(e => e.Region === selectedRegion).map(e => e.Division))];
    divisionSelect.innerHTML = `<option value="">Select</option>` + divisions.map(d => `<option>${d}</option>`).join("");

    // Reset downstream
    substationSelect.innerHTML = `<option value="">Select</option>`;

    // Trigger PTR filtering
    populatePTRDropdown();
  });

  divisionSelect.addEventListener("change", () => {
    const selectedRegion = regionSelect.value;
    const selectedDivision = divisionSelect.value;

    // Populate Substation
    const substations = [...new Set(mapData
      .filter(e => e.Region === selectedRegion && e.Division === selectedDivision)
      .map(e => e.Substation))];
    substationSelect.innerHTML = `<option value="">Select</option>` + substations.map(s => `<option>${s}</option>`).join("");

    // Trigger PTR filtering
    populatePTRDropdown();
  });

  substationSelect.addEventListener("change", () => {
    populatePTRDropdown();
  });
}


function populateModalRegionDropdown() {
  const modalRegionSelect = document.getElementById("modalRegion");
  modalRegionSelect.innerHTML = `<option value="">Select</option>` + [...new Set(mapData.map(e => e.Region))]
    .map(r => `<option value="${r}">${r}</option>`).join("");

  modalRegionSelect.onchange = () => {
    const selectedRegion = modalRegionSelect.value;
    const divisions = [...new Set(mapData.filter(e => e.Region === selectedRegion).map(e => e.Division))];
    const modalDivisionSelect = document.getElementById("modalDivision");
    modalDivisionSelect.innerHTML = `<option value="">Select</option>` + divisions.map(d => `<option value="${d}">${d}</option>`).join("");

    document.getElementById("modalSubstation").innerHTML = `<option value="">Select</option>`;

    modalDivisionSelect.onchange = () => {
      const selectedDivision = modalDivisionSelect.value;
      const substations = [...new Set(mapData.filter(e => e.Division === selectedDivision).map(e => e.Substation))];
      const modalSubstationSelect = document.getElementById("modalSubstation");
      modalSubstationSelect.innerHTML = `<option value="">Select</option>` + substations.map(s => `<option value="${s}">${s}</option>`).join("");
    };
  };
}

function populatePTRDropdown() {
  const region = document.getElementById("region").value;
  const division = document.getElementById("division").value;
  const substation = document.getElementById("substation").value;
  const ptrSelect = document.getElementById("ptrSelect");

  let filteredPTRs = ptrData;

  if (region) {
    filteredPTRs = filteredPTRs.filter(p => p.Region === region);
  }
  if (division) {
    filteredPTRs = filteredPTRs.filter(p => p.Division === division);
  }
  if (substation) {
    filteredPTRs = filteredPTRs.filter(p => p.Substation === substation);
  }

  ptrSelect.innerHTML = `<option value="">Select</option>` + filteredPTRs.map(p =>
    `<option value="${p['Serial No.']}">${p['Equipment']} | ${p['Make']} | ${p['Capacity (MVA)']} | ${p['Serial No.']} | ${p['Year of Manufacture']}</option>`
  ).join("");
}



function populateYearDropdown() {
  const yearSelect = document.getElementById("yearDropdown");
  const currentYear = new Date().getFullYear();
  let options = `<option value="">Select</option>`;
  for (let y = currentYear; y >= 1990; y--) {
    options += `<option value="${y}">${y}</option>`;
  }
  yearSelect.innerHTML = options;
}


function showPTRModal() {
  // Call population function
  populateModalRegionDropdown();

  // Pre-fill selected values
  const region = document.getElementById("region").value;
  const division = document.getElementById("division").value;
  const substation = document.getElementById("substation").value;

  setTimeout(() => {
    const modalRegion = document.getElementById("modalRegion");
    modalRegion.value = region;
    modalRegion.dispatchEvent(new Event('change'));

    setTimeout(() => {
      const modalDivision = document.getElementById("modalDivision");
      modalDivision.value = division;
      modalDivision.dispatchEvent(new Event('change'));

      setTimeout(() => {
        const modalSubstation = document.getElementById("modalSubstation");
        modalSubstation.value = substation;
      }, 150);
    }, 150);
  }, 150);

  new bootstrap.Modal(document.getElementById("ptrModal")).show();
}


// Submit test form
document.getElementById("testForm").addEventListener("submit", function (e) {
  e.preventDefault();
  const form = e.target;
  
  // Get form data
  const formData = new FormData(form);
  const record = Object.fromEntries(formData.entries());

  // Add selected dropdown values
  record.Region = document.getElementById("region").value;
  record.Division = document.getElementById("division").value;
  record.Substation = document.getElementById("substation").value;

  // Add PTR details - ensure all PTR fields are included
const ptrSerial = document.getElementById("ptrSelect").value.trim();
const ptrDetails = ptrData.find(p => String(p['Serial No.']).trim() === ptrSerial);

  if (ptrDetails) {
    // Explicitly add each PTR field to ensure they're included
    record.Equipment = ptrDetails.Equipment || '';
    record['Capacity (MVA)'] = ptrDetails['Capacity (MVA)'] || '';
    record.Make = ptrDetails.Make || '';
    record['Serial No.'] = ptrDetails['Serial No.'] || '';
    record['Year of Manufacture'] = ptrDetails['Year of Manufacture'] || '';
    
    // Also copy any other PTR fields that might exist
    Object.keys(ptrDetails).forEach(key => {
      if (!record.hasOwnProperty(key)) {
        record[key] = ptrDetails[key];
      }
    });
  }

  console.log('Test Record Data:', record); // Debug log to verify data

  // Store pending record and show confirmation
  pendingTestRecord = record;
  
  // Create summary for confirmation
const summary = `
  <strong>Region:</strong> ${record.Region}<br>
  <strong>Division:</strong> ${record.Division}<br>
  <strong>Substation:</strong> ${record.Substation}<br>
  <strong>Equipment:</strong> ${record.Equipment || 'N/A'}<br>
  <strong>Capacity (MVA):</strong> ${record['Capacity (MVA)'] || 'N/A'}<br>
  <strong>Make:</strong> ${record.Make || 'N/A'}<br>
  <strong>Serial No.:</strong> ${record['Serial No.'] || 'N/A'}<br>
  <strong>Year of Manufacture:</strong> ${record['Year of Manufacture'] || 'N/A'}<br>
  <strong>Sample Collection Date:</strong> ${record['Sample Collection Date'] || 'N/A'}<br>
  <strong>Sample Testing Date:</strong> ${record['Sample Testing Date'] || 'N/A'}<br>
  <strong>Sample Collected By:</strong> ${record['Sample Collected By'] || 'N/A'}<br>
  <strong>Source Referance:</strong> ${record['Source Referance'] || 'N/A'}<br>
  <strong>Testing Referance:</strong> ${record['Testing Referance'] || 'N/A'}<br>
  <strong>Oil Sample Position:</strong> ${record['Oil Sample Position'] || 'N/A'}<br>
  <strong>Physical Appearance:</strong> ${record['Physical Appearance'] || 'N/A'}<br>
  <strong>Density (gm/CC):</strong> ${record['Density (gm/CC)'] || 'N/A'}<br>
  <strong>BDV with 2.5mm Gap (kV):</strong> ${record['BDV with 2.5mm Gap (kV)'] || 'N/A'}<br>
  <strong>Acidity (mg of KOH/gm):</strong> ${record['Acidity (mg of KOH/gm)'] || 'N/A'}<br>
  <strong>Specific Resistance at 27 °C (ohm-cm):</strong> ${record['Specific Resistance at 27 °C (ohm-cm)'] || 'N/A'}<br>
  <strong>Specific Resistance at 90 °C (ohm-cm):</strong> ${record['Specific Resistance at 90 °C (ohm-cm)'] || 'N/A'}<br>
  <strong>Dielectric Disssipation Factor (tan δ):</strong> ${record['Dielectric Disssipation Factor (tan δ)'] || 'N/A'}<br>
  <strong>Moisture Content (PPM):</strong> ${record['Moisture Content (PPM)'] || 'N/A'}<br>
  <strong>IFT (mN/m):</strong> ${record['IFT (mN/m)'] || 'N/A'}<br>
  <strong>Observations:</strong> ${record['Observations'] || 'N/A'}<br>
`;

  
  document.getElementById('testRecordSummary').innerHTML = summary;
  new bootstrap.Modal(document.getElementById('confirmTestModal')).show();
});

// Confirm test record submission
document.getElementById("confirmTestSubmit").addEventListener("click", function () {
  const button = this;
  setLoadingState(button, true);
  
  // Submit to Google Apps Script
  fetch(scriptUrl, {
    method: 'POST',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
    body: `action=submitTestRecord&${new URLSearchParams({data: JSON.stringify(pendingTestRecord)}).toString()}`
  })
  .then(res => res.json())
  .then(result => {
    setLoadingState(button, false);
    bootstrap.Modal.getInstance(document.getElementById('confirmTestModal')).hide();
    
    // Reset form
    document.getElementById("testForm").reset();
    document.getElementById("region").value = "";
    document.getElementById("division").innerHTML = `<option value="">Select</option>`;
    document.getElementById("substation").innerHTML = `<option value="">Select</option>`;
    document.getElementById("ptrSelect").value = "";
    
    showSuccessModal("Test Record Submitted Successfully!");
    pendingTestRecord = null;
  })
  .catch(err => {
    setLoadingState(button, false);
    console.error('Error submitting test record:', err);
    alert("Error submitting record. Please try again.");
  });
});

// Submit PTR modal form
document.getElementById("ptrForm").addEventListener("submit", function (e) {
  e.preventDefault();
  const form = e.target;
  const formData = new FormData(form);
  const data = Object.fromEntries(formData.entries());

  // Always force Equipment = PTR
  data.Equipment = "PTR";

  // Check for duplicates
  const duplicate = ptrData.find(p =>
    p.Region === data.Region &&
    p.Division === data.Division &&
    p.Equipment === "PTR" &&
    p["Capacity (MVA)"] === data["Capacity (MVA)"] &&
    p.Make === data.Make &&
    p["Serial No."] === data["Serial No."] &&
    p["Year of Manufacture"] === data["Year of Manufacture"]
  );

  if (duplicate) {
    alert("A PTR with the same details already exists in this Region and Division.\nDuplicate entry not allowed.");
    return;
  }

  // ✅ Store pending data and show confirmation
  pendingPtrData = data;

  // Create summary for confirmation
  const summary = `
    <strong>Region:</strong> ${data.Region}<br>
    <strong>Division:</strong> ${data.Division}<br>
    <strong>Substation:</strong> ${data.Substation}<br>
    <strong>Equipment:</strong> ${data.Equipment}<br>
    <strong>Capacity (MVA):</strong> ${data['Capacity (MVA)'] || 'N/A'}<br>
    <strong>Make:</strong> ${data.Make || 'N/A'}<br>
    <strong>Serial No.:</strong> ${data['Serial No.']}<br>
    <strong>Year of Manufacture:</strong> ${data['Year of Manufacture'] || 'N/A'}
  `;

  document.getElementById('ptrSummary').innerHTML = summary;

  bootstrap.Modal.getInstance(document.getElementById('ptrModal')).hide();
  new bootstrap.Modal(document.getElementById('confirmPtrModal')).show();
});


// Confirm PTR submission
document.getElementById("confirmPtrSubmit").addEventListener("click", function () {
  const button = this;
  setLoadingState(button, true);
  
  // Submit PTR to Google Apps Script
  fetch(scriptUrl, {
    method: 'POST',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
    body: `action=addPTR&${new URLSearchParams({data: JSON.stringify(pendingPtrData)}).toString()}`
  })
  .then(res => res.json())
  .then(result => {
    setLoadingState(button, false);
    bootstrap.Modal.getInstance(document.getElementById('confirmPtrModal')).hide();
    
    // Reset PTR form
    document.getElementById("ptrForm").reset();
    
    // Refresh data to include new PTR
    fetchData();
      populateYearDropdown(); // ✅ this ensures the dropdown exists in the DOM

    
showSuccessModal("PTR Added Successfully!", true);
    pendingPtrData = null;
  })
  .catch(err => {
    setLoadingState(button, false);
    console.error('Error adding PTR:', err);
    alert("Error adding PTR. Please try again.");
  });
});


document.addEventListener("DOMContentLoaded", () => {
  const collectionInput = document.getElementById("sampleCollectionDate");
  const testingInput = document.getElementById("sampleTestingDate");

  collectionInput.addEventListener("change", () => {
    if (collectionInput.value) {
      testingInput.min = collectionInput.value;
      if (testingInput.value && testingInput.value < collectionInput.value) {
        testingInput.value = "";
      }
    }
  });

  testingInput.addEventListener("change", () => {
    if (collectionInput.value && testingInput.value < collectionInput.value) {
      alert("Sample Testing Date must be after Sample Collection Date.");
      testingInput.value = "";
    }
  });
});

</script>

</body>
</html>
