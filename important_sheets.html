<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Important Data Sheets</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f0f2f5;
            color: #1c1e21;
            margin: 0;
            padding: 16px;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        h1 {
            font-size: 24px;
            color: #111827;
            margin-bottom: 8px;
        }
        p {
            color: #4b5563;
            font-size: 14px;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .links-grid {
            display: grid;
            gap: 12px;
        }
        .link-card {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px;
            background-color: #fff;
            border-radius: 10px;
            text-decoration: none;
            color: #111827;
            font-weight: 600;
            font-size: 15px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            transition: all 0.2s ease;
        }
        .link-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            border-color: #d1d5db;
        }
        .link-card i {
            width: 24px;
            text-align: center;
            font-size: 18px;
            color: #4b5563;
        }
        
        /* Tree/Accordion Styles */
        .tree-header {
            cursor: pointer;
            justify-content: space-between;
            user-select: none;
        }
        .tree-header.active {
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            border-bottom-color: transparent;
            background-color: #f9fafb;
        }
        .tree-content {
            display: none;
            background: #fff;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 10px 10px;
            overflow: hidden;
            margin-top: -1px;
            box-shadow: 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .child-link {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px 12px 50px;
            text-decoration: none;
            color: #374151;
            font-size: 14px;
            border-top: 1px solid #f3f4f6;
            transition: background 0.2s;
        }
        .child-link:hover:not(.disabled) {
            background-color: #f3f4f6;
            color: #111827;
        }
        .child-link.disabled {
            color: #9ca3af;
            cursor: default;
            background-color: #fafafa;
        }
        .chevron-icon {
            font-size: 14px !important;
            width: auto !important;
            transition: transform 0.3s ease;
        }
        .tree-header.active .chevron-icon {
            transform: rotate(180deg);
        }
        /* Hide child links that are placeholders or empty */
        .child-link[href="#"], .child-link[href=""] {
            display: none;
        }

        .download-button {
            background-color: #e5e7eb;
            border: none;
            border-radius: 6px;
            color: #374151;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .download-button:hover {
            background-color: #d1d5db;
        }

        .whatsapp-button {
            background-color: #25D366;
            border: none;
            border-radius: 6px;
            color: white;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .whatsapp-button:hover {
            background-color: #1DA851;
        }

        .highlight-value {
            background-color: #d4edda; /* Light green background */
            color: #155724; /* Dark green text */
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 8px;
            font-size: 0.9em;
            font-weight: 700;
        }
        .alert-badge {
  margin-left: 6px;
  background: #dc2626;
  color: #ffffff;
  font-size: 12px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 6px;
}

    </style>
</head>
<body>

    <div class="container">
        <h1>Important Data Sheets</h1>
        <p>Open the required Google Sheet in a new tab or download it as an XLSX file.</p>

        <div class="links-grid">
            <!-- Tree Structure for Unbilled -->
            <div class="tree-group">
                <div class="link-card tree-header" onclick="toggleTree(this)">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <span>Unbilled upto date</span>
                    </div>
                    <i class="fas fa-chevron-down chevron-icon"></i>
                </div>
<div class="tree-content" id="unbilled-months"></div>

            </div>

            <div class="link-card" id="three-months-unbilled-card">
                <a href="https://docs.google.com/spreadsheets/d/1g_YAYXocaaEDh42WpgT5jqzEwWMgwtvfrXP2J3Jh8lw/edit?gid=0#gid=0" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 12px; flex-grow: 1;">
                    <i class="fas fa-calendar-times"></i>
                    <span>3 Monhs Unbilled <span id="s60-value" class="highlight-value"></span></span>
                </a>
                <div>
                    <button class="whatsapp-button" onclick="shareOnWhatsApp(event, 'https://docs.google.com/spreadsheets/d/1g_YAYXocaaEDh42WpgT5jqzEwWMgwtvfrXP2J3Jh8lw/edit?gid=0#gid=0', '3 Monhs Unbilled')">
                        <i class="fab fa-whatsapp"></i>
                    </button>
                    <a href="https://docs.google.com/spreadsheets/d/1g_YAYXocaaEDh42WpgT5jqzEwWMgwtvfrXP2J3Jh8lw/export?format=xlsx" download class="download-button">
                        <i class="fas fa-download"></i>
                    </a>
                </div>
            </div>
<div class="link-card">
                 <a href="https://docs.google.com/spreadsheets/d/1gPNCdyhoGNZy5i6FFp2HBIHs4-4FelNWGWThmC8PeQE/edit?gid=0#gid=0" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 12px; flex-grow: 1;">
                    <i class="fas fa-file-signature"></i>
<span>
    1st Bill not generated
    <span id="j57-value" class="highlight-value"></span>
</span>
                </a>
                <div>
                    <button class="whatsapp-button" onclick="shareOnWhatsApp(event, 'https://docs.google.com/spreadsheets/d/1gPNCdyhoGNZy5i6FFp2HBIHs4-4FelNWGWThmC8PeQE/edit?gid=0#gid=0', '1st Bill not generated')">
                        <i class="fab fa-whatsapp"></i>
                    </button>
                    <a href="https://docs.google.com/spreadsheets/d/1gPNCdyhoGNZy5i6FFp2HBIHs4-4FelNWGWThmC8PeQE/export?format=xlsx" download class="download-button">
                        <i class="fas fa-download"></i>
                    </a>
                </div>
            </div>
            <div class="link-card">
                <a href="https://docs.google.com/spreadsheets/d/1-stbDqVWjFfeftqpe20zQOw2NFKj6595ptBLrCG-__s/edit?gid=1066479111#gid=1066479111" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 12px; flex-grow: 1;">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Smart Metering</span>
                </a>
                <div>
                    <button class="whatsapp-button" onclick="shareOnWhatsApp(event, 'https://docs.google.com/spreadsheets/d/1-stbDqVWjFfeftqpe20zQOw2NFKj6595ptBLrCG-__s/edit?gid=1066479111#gid=1066479111', 'Smart Metering')">
                        <i class="fab fa-whatsapp"></i>
                    </button>
                    <a href="https://docs.google.com/spreadsheets/d/1-stbDqVWjFfeftqpe20zQOw2NFKj6595ptBLrCG-__s/export?format=xlsx" download class="download-button">
                        <i class="fas fa-download"></i>
                    </a>
                </div>
            </div>
            <div class="link-card">
                <a href="https://docs.google.com/spreadsheets/d/1kB6g0zxWqR7sX6KiJaHG1pn0Fq_CWFAjyLzDNyOvpDY/edit?gid=0#gid=0" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 12px; flex-grow: 1;">
                    <i class="fas fa-clipboard-list"></i>
                    <span>REM OSD Follow-up</span>
                </a>
                <div>
                    <button class="whatsapp-button" onclick="shareOnWhatsApp(event, 'https://docs.google.com/spreadsheets/d/1kB6g0zxWqR7sX6KiJaHG1pn0Fq_CWFAjyLzDNyOvpDY/edit?gid=0#gid=0', 'REM OSD Follow-up')">
                        <i class="fab fa-whatsapp"></i>
                    </button>
                    <a href="https://docs.google.com/spreadsheets/d/1kB6g0zxWqR7sX6KiJaHG1pn0Fq_CWFAjyLzDNyOvpDY/export?format=xlsx" download class="download-button">
                        <i class="fas fa-download"></i>
                    </a>
                </div>
            </div>
            <div class="link-card">
                <a href="https://docs.google.com/spreadsheets/d/1It8j3Ic8mjoVf7ejljj1VrN7LEEnqg-9A8n7BY3UrQM/edit?gid=0#gid=0" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 12px; flex-grow: 1;">
                    <i class="fas fa-arrow-down"></i>
                    <span>REM Less Unit billed</span>
                </a>
                <div>
                    <button class="whatsapp-button" onclick="shareOnWhatsApp(event, 'https://docs.google.com/spreadsheets/d/1It8j3Ic8mjoVf7ejljj1VrN7LEEnqg-9A8n7BY3UrQM/edit?gid=0#gid=0', 'REM Less Unit billed')">
                        <i class="fab fa-whatsapp"></i>
                    </button>
                    <a href="https://docs.google.com/spreadsheets/d/1It8j3Ic8mjoVf7ejljj1VrN7LEEnqg-9A8n7BY3UrQM/export?format=xlsx" download class="download-button">
                        <i class="fas fa-download"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleTree(element) {
            element.classList.toggle('active');
            const content = element.nextElementSibling;
            if (element.classList.contains('active')) {
                content.style.display = 'block';
            } else {
                content.style.display = 'none';
            }
        }

        function shareOnWhatsApp(event, url, name) {
            event.stopPropagation();
            const message = `${name}: ${url}`;
            const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }
document.addEventListener('DOMContentLoaded', async () => {

    // Reusable cell fetcher
    async function fetchCellValue(sheetId, range, targetId) {
        const url =
            `https://docs.google.com/spreadsheets/d/${sheetId}` +
            `/export?format=csv&range=${range}`;

        try {
            const res = await fetch(url);
            const text = await res.text();
            const value = text.replace(/"/g, '').trim();

            document.getElementById(targetId).textContent =
                value || 'N/A';
        } catch (err) {
            console.error(`Fetch failed for ${range}:`, err);
            document.getElementById(targetId).textContent = 'N/A';
        }
    }

    // 3 Months Unbilled â†’ S60
    fetchCellValue(
        '1g_YAYXocaaEDh42WpgT5jqzEwWMgwtvfrXP2J3Jh8lw',
        'S60',
        's60-value'
    );

    // 1st Bill Not Generated â†’ J57
    fetchCellValue(
        '1gPNCdyhoGNZy5i6FFp2HBIHs4-4FelNWGWThmC8PeQE',
        'J57',
        'j57-value'
    );

});

async function fetchCell(sheetId, range, elementId, prefix) {
  if (!sheetId || sheetId === "#") return;

  const el = document.getElementById(elementId);
  if (!el) return;

  const url =
    `https://docs.google.com/spreadsheets/d/${sheetId}` +
    `/export?format=csv&range=${range}`;

  try {
    const res = await fetch(url);
    const text = await res.text();
    const value = text.replace(/"/g, "").trim();
    el.textContent = `${prefix}:${value || "0"}`;
  } catch {
    el.textContent = `${prefix}:â€”`;
  }
}

document.addEventListener("DOMContentLoaded", () => {

const months = {
  jan: "1ujR9e1olZKeu1uIgzSsIl2XXK-fN6YWI-1Z_E6xyOTs",
  feb: "#",
  mar: "#",
  apr: "#",
  may: "#",
  jun: "#",
  jul: "#",
  aug: "#",
  sep: "#",
  oct: "#",
  nov: "#",
  dec: "#"
};


  for (const [key, sheetId] of Object.entries(months)) {
    fetchCell(sheetId, "D57", `${key}-q`, "Q");
    fetchCell(sheetId, "E57", `${key}-m`, "M");
  }
  renderUnbilledMonths();

});

const unbilledMonths = [
  {
    key: "jan",
    label: "Jan-2026",
    sheetId: "1ujR9e1olZKeu1uIgzSsIl2XXK-fN6YWI-1Z_E6xyOTs",
    gid: "979760067"
  },
  {
    key: "feb",
    label: "Feb-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "mar",
    label: "Mar-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "apr",
    label: "Apr-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "may",
    label: "May-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "jun",
    label: "Jun-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "jul",
    label: "Jul-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "aug",
    label: "Aug-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "sep",
    label: "Sep-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "oct",
    label: "Oct-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "nov",
    label: "Nov-2026",
    sheetId: "#",
    gid: ""
  },
  {
    key: "dec",
    label: "Dec-2026",
    sheetId: "#",
    gid: ""
  }
];
function renderUnbilledMonths() {
  const container = document.getElementById("unbilled-months");
  if (!container) return;

  container.innerHTML = "";

unbilledMonths.forEach(month => {
  const hasSheet = month.sheetId && month.sheetId !== "#";

  // ðŸ”´ NEW: skip months without real link
  if (!hasSheet) return;

  const viewLink =
    `https://docs.google.com/spreadsheets/d/${month.sheetId}/edit?gid=${month.gid}`;

  const downloadLink =
    `https://docs.google.com/spreadsheets/d/${month.sheetId}/export?format=xlsx`;

  const row = document.createElement("div");
  row.className = "child-link";

  row.innerHTML = `
    <a href="${viewLink}" target="_blank">
      <span>
        ${month.label}
        <span id="${month.key}-q" class="alert-badge">Q:â€”</span>
        <span id="${month.key}-m" class="alert-badge">M:â€”</span>
      </span>
    </a>

    <div>
      <button class="whatsapp-button"
        onclick="shareOnWhatsApp(
          event,
          '${viewLink}',
          '${month.label} Unbilled'
        )">
        <i class="fab fa-whatsapp"></i>
      </button>

      <a href="${downloadLink}" class="download-button">
        <i class="fas fa-download"></i>
      </a>
    </div>
  `;

  container.appendChild(row);

  // Fetch values
  fetchCell(month.sheetId, "D57", `${month.key}-q`, "Q");
  fetchCell(month.sheetId, "E57", `${month.key}-m`, "M");
});

}

    </script>


<!--
========================================================================
ðŸ“Œ FUTURE UPDATE GUIDELINES â€” UNBILLED MONTHS CONFIGURATION
========================================================================

This page dynamically renders monthly "Unbilled upto date" entries
from the `unbilledMonths` JavaScript array.

-----------------------------------------------------------------------
HOW TO ADD / UPDATE A MONTH (STEP-BY-STEP)
-----------------------------------------------------------------------

1ï¸âƒ£ Locate the configuration block in JavaScript:

    const unbilledMonths = [
      {
        key: "jan",
        label: "Jan-2026",
        sheetId: "SHEET_ID_HERE",
        gid: "SHEET_TAB_GID"
      },
      ...
    ];

2ï¸âƒ£ To ACTIVATE a month:
   - Replace sheetId "#" with the real Google Sheet ID
   - Set the correct `gid` (tab ID) if required

   Example:
   ------------------------------------------------
   {
     key: "feb",
     label: "Feb-2026",
     sheetId: "1abcDEFghiJKLmnoPQRstuVWxyz",
     gid: "123456789"
   }
   ------------------------------------------------

3ï¸âƒ£ To HIDE a month:
   - Set sheetId to "#"
   - The month will NOT appear in the UI

4ï¸âƒ£ IMPORTANT RULES:
   - `key` must be unique (used for element IDs)
   - Sheet MUST be "Published to web"
   - Cells D57 (Q) and E57 (M) must contain data
   - Do NOT manually add month HTML â€” it is auto-generated

5ï¸âƒ£ DATA SOURCE PER MONTH:
   - Q value â†’ Cell D57
   - M value â†’ Cell E57

6ï¸âƒ£ FEATURES AUTOMATICALLY ENABLED FOR ACTIVE MONTHS:
   âœ” Month name display
   âœ” Q & M live values
   âœ” WhatsApp share button
   âœ” XLSX download button
   âœ” Click-to-open Google Sheet

-----------------------------------------------------------------------
âš ï¸ DO NOT EDIT HTML MONTH ROWS MANUALLY
All month rows are rendered dynamically via JavaScript.
-----------------------------------------------------------------------

Last updated: (update this comment when logic changes)
========================================================================
-->



</body>
</html>
